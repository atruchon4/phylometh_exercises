plan <- drake_plan(
  tree.primates = read.tree(text="((((Homo:0.21,Pongo:0.21):0.28,Macaca:0.49):0.13,Ateles:0.62):0.38,Galago:1.00);") ,
  X <- c(4.09434, 3.61092, 2.37024, 2.02815, -1.46968),
  Y <- c(4.74493, 3.33220, 3.36730, 2.89037, 2.30259),
  names(X) <- names(Y) <- c("Homo", "Pongo", "Macaca", "Ateles", "Galago"),
  pic.X = pic(X, tree.primates),
  pic.Y = pic(Y, tree.primates),
  require("corHMM"),
  data(primates),
  print(primates),
  require(phytools),
  primates$trait[which(grepl("Hylobates",primates$trait[,1])),2]<- 1,
  trait1 = primates$trait[,2],
  names(trait1) <- primates$trait[,1],
  primates$tree <- ape::multi2di(primates$tree),
  plotSimmap(make.simmap(primates$tree, trait1), pts=FALSE, fsize=0.8),
  rate.mat.er = rate.mat.maker(rate.cat=1, hrm=FALSE, ntraits=1, nstates=2, model="ER"),
  print(rate.mat.er),
  pp.er = corHMM(primates$tree,primates$trait[,c(1,2)],rate.cat=1,rate.mat=rate.mat.er,node.states="marginal"),
  print(pp.er),
  
  )